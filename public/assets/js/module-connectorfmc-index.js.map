{"version":3,"sources":["src/module-connectorfmc-index.js"],"names":["idUrl","idForm","className","inputClassName","ModuleConnectorFMC","$formObj","$","$checkBoxes","$dropDowns","$disabilityFields","validateRules","incomingEndpointPort","identifier","rules","type","prompt","globalTranslate","module_connectorfmc_incomingEndpointPortIsEmpty","incomingEndpointLogin","module_connectorfmc_incomingEndpointLoginIsEmpty","incomingEndpointSecret","module_connectorfmc_incomingEndpointSecretIsEmpty","incomingEndpointHost","module_connectorfmc_incomingEndpointHostIsEmpty","sipPort","module_connectorfmc_sipPortIsEmpty","amiPort","module_connectorfmc_amiPortIsEmpty","rtpPortStart","module_connectorfmc_rtpPortStartIsEmpty","rtpPortEnd","module_connectorfmc_rtpPortEndIsEmpty","initialize","window","checkbox","parent","dropdown","tab","accordion","initializeForm","find","on","attr","generateUID","toUpperCase","trigger","val","length","charset","password","i","randomIndex","Math","floor","random","cbBeforeSendForm","settings","result","data","form","extensions","peers","join","cbAfterSendForm","Form","url","globalRootUrl","document","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 11 2018\n *\n */\nconst idUrl     = 'module-connector-f-m-c';\nconst idForm    = 'module-connectorfmc-form';\nconst className = 'ModuleConnectorFMC';\nconst inputClassName = 'mikopbx-module-input';\n\n/* global globalRootUrl, globalTranslate, Form, Config, $ */\nconst ModuleConnectorFMC = {\n\t$formObj: $('#'+idForm),\n\t$checkBoxes: $('#'+idForm+' .ui.checkbox'),\n\t$dropDowns: $('#'+idForm+' .ui.dropdown'),\n\t$disabilityFields: $('#'+idForm+'  .disability'),\n\n\t/**\n\t * Field validation rules\n\t * https://semantic-ui.com/behaviors/form.html\n\t */\n\tvalidateRules: {\n\t\tincomingEndpointPort: {\n\t\t\tidentifier: 'incomingEndpointPort',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'integer[1..65000]',\n\t\t\t\t\tprompt: globalTranslate.module_connectorfmc_incomingEndpointPortIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tincomingEndpointLogin: {\n\t\t\tidentifier: 'incomingEndpointLogin',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype   : 'empty',\n\t\t\t\t\tprompt: globalTranslate.module_connectorfmc_incomingEndpointLoginIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tincomingEndpointSecret: {\n\t\t\tidentifier: 'incomingEndpointSecret',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype   : 'empty',\n\t\t\t\t\tprompt: globalTranslate.module_connectorfmc_incomingEndpointSecretIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tincomingEndpointHost: {\n\t\t\tidentifier: 'incomingEndpointHost',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype   : 'empty',\n\t\t\t\t\tprompt: globalTranslate.module_connectorfmc_incomingEndpointHostIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tsipPort: {\n\t\t\tidentifier: 'sipPort',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype   : 'integer[5160..65000]',\n\t\t\t\t\tprompt: globalTranslate.module_connectorfmc_sipPortIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tamiPort: {\n\t\t\tidentifier: 'amiPort',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype   : 'integer[55000..60000]',\n\t\t\t\t\tprompt: globalTranslate.module_connectorfmc_amiPortIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\trtpPortStart: {\n\t\t\tidentifier: 'rtpPortStart',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype   : 'integer[40000..65000]',\n\t\t\t\t\tprompt: globalTranslate.module_connectorfmc_rtpPortStartIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\trtpPortEnd: {\n\t\t\tidentifier: 'rtpPortEnd',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype   : 'integer[40000..65000]',\n\t\t\t\t\tprompt: globalTranslate.module_connectorfmc_rtpPortEndIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t},\n\t/**\n\t * On page load we init some Semantic UI library\n\t */\n\tinitialize() {\n\t\t// инициализируем чекбоксы и выподающие менюшки\n\t\twindow[className].$checkBoxes.checkbox();\n\n\t\t$('#useDelayedResponse').parent().checkbox()\n\n\t\twindow[className].$dropDowns.dropdown();\n\t\t$('.menu .item').tab();\n\t\t$(\".accordion\").accordion();\n\t\twindow[className].initializeForm();\n\n\t\t$('#outputEndpoint').parent().find('i').on('click', function() {\n\t\t\t$(this).parent().find('input').attr('value', 'SIP-FMC-'+window[className].generateUID(8).toUpperCase());\n\t\t\t$(this).parent().find('input').trigger('change');\n\t\t});\n\t\t$('#outputEndpointSecret').parent().find('i').on('click', function() {\n\t\t\t$(this).parent().find('input').val(window[className].generateUID(32));\n\t\t\t$(this).parent().find('input').trigger('change');\n\t\t});\n\t},\n\n\t/**\n\t * Create new password\n\t * @param length\n\t * @returns {string}\n\t */\n\tgenerateUID(length) {\n\t\tconst charset = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n\t\tlet password = \"\";\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst randomIndex = Math.floor(Math.random() * charset.length);\n\t\t\tpassword += charset[randomIndex];\n\t\t}\n\t\treturn password;\n\t},\n\t/**\n\t * We can modify some data before form send\n\t * @param settings\n\t * @returns {*}\n\t */\n\tcbBeforeSendForm(settings) {\n\t\tconst result = settings;\n\t\tresult.data = window[className].$formObj.form('get values');\n\t\tresult.data.extensions = result.data.peers.join(',');\n\t\tdelete result.data.peers;\n\t\treturn result;\n\t},\n\t/**\n\t * Some actions after forms send\n\t */\n\tcbAfterSendForm() {\n\t},\n\t/**\n\t * Initialize form parameters\n\t */\n\tinitializeForm() {\n\t\tForm.$formObj = window[className].$formObj;\n\t\tForm.url = `${globalRootUrl}${idUrl}/save`;\n\t\tForm.validateRules = window[className].validateRules;\n\t\tForm.cbBeforeSendForm = window[className].cbBeforeSendForm;\n\t\tForm.cbAfterSendForm = window[className].cbAfterSendForm;\n\t\tForm.initialize();\n\t},\n};\n\n$(document).ready(() => {\n\twindow[className].initialize();\n});\n\n"],"file":"module-connectorfmc-index.js"}